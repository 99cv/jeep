import{r as t,h as i,H as s,g as h}from"./p-f5b4c7c2.js";import{g as l,d as e,a as r,b as a,c as n,e as o}from"./p-872157c0.js";const u=(t,i)=>{const s=document.createElementNS("http://www.w3.org/2000/svg",t);return i&&i.appendChild(s),s},c=(t,i,s,h)=>{let l=M(h),e=u("text",t);return e.setAttributeNS(null,"x",s.x.toString()),e.setAttributeNS(null,"y",s.y.toString()),e.textContent=i,k(l,e,"text"),e},d=(t,i,s,h)=>{let l=t.querySelector("#"+i);return l.setAttributeNS(null,"x",h.x.toString()),l.setAttributeNS(null,"y",h.y.toString()),l.setAttributeNS(null,"text-anchor",s),l},f=(t,i,s,h)=>{let l=M(h),e=u("line",t);return e.setAttributeNS(null,"x1",i.x.toString()),e.setAttributeNS(null,"y1",i.y.toString()),e.setAttributeNS(null,"x2",s.x.toString()),e.setAttributeNS(null,"y2",s.y.toString()),k(l,e),e},x=(t,i,s,h)=>{let l=t.querySelector("#"+i);return l.setAttributeNS(null,"x1",s.x.toString()),l.setAttributeNS(null,"y1",s.y.toString()),l.setAttributeNS(null,"x2",h.x.toString()),l.setAttributeNS(null,"y2",h.y.toString()),l},p=(t,i,s)=>{let h=M(s),l=u("polyline",t);return l.setAttributeNS(null,"points",i),k(h,l),l},y=(t,i,s)=>{let h=t.querySelector("#"+i);return h.setAttributeNS(null,"points",s),h},m=(t,i,s)=>{let h=u("g",t);h.setAttribute("id",s.id),h.setAttribute("viewbox",s.viewbox),u("path",h).setAttribute("d",i)},g=(t,i,s,h,l,e,r,a)=>{let n,o,u,c,d=0,f=r;for(let x=0;x<l.nLines;x++){for(let r=0;r<l.nItems&&(o={x:(n=0===r?{x:e/2-l.lineLength/2,y:f}:{x:n.x+l.bBoxItem.width+20,y:n.y}).x+15,y:n.y},u={x:n.x+20,y:n.y},c={stroke:s[d],strokeWidth:h[d].toString()},b(t,n,o,c,i[d],u,a),!((d+=1)>=i.length));r++);f+=l.bBoxItem.height+2}},b=(t,i,s,h,l,e,r)=>{f(t,i,s,h),c(t,l,e,r)},M=t=>{let i={},s=t||{};return i.id=s.id?s.id:null,i.fontFamily=s.fontFamily?s.fontFamily:"Verdana",i.fontSize=s.fontSize?s.fontSize:"10px",i.fill=s.fill?s.fill:null,i.fillOpacity=s.fillOpacity?s.fillOpacity:null,i.anchor=["start","middle","end"].indexOf(s.anchor)>-1?s.anchor:null,i.stroke=s.stroke?s.stroke:null,i.strokeWidth=s.strokeWidth?s.strokeWidth:null,i.strokeOpacity=s.strokeOpacity?s.strokeOpacity:null,i.strokeLinejoin=["miter","round","bevel"].indexOf(s.strokeLinejoin)>-1?s.strokeLinejoin:null,i.strokeLinecap=["butt","round","square"].indexOf(s.strokeLinecap)>-1?s.strokeLinecap:null,i.strokeMiterlimit=s.strokeMiterlimit?s.strokeMiterlimit:null,i.strokeDasharray=s.strokeDasharray?s.strokeDasharray:null,i.strokeDashoffset=s.strokeDashoffset?s.strokeDashoffset:null,i},k=(t,i,s)=>{let h=s||null;null!==t.id&&i.setAttributeNS(null,"id",t.id),"text"===h&&i.setAttributeNS(null,"font-family",t.fontFamily),"text"===h&&i.setAttributeNS(null,"font-size",t.fontSize),"text"===h&&null!==t.anchor&&i.setAttributeNS(null,"text-anchor",t.anchor),null!==t.fill&&i.setAttributeNS(null,"fill",t.fill),null!==t.fillOpacity&&i.setAttributeNS(null,"fill-opacity",t.fillOpacity),null!==t.stroke&&i.setAttributeNS(null,"stroke",t.stroke),null!==t.strokeWidth&&i.setAttributeNS(null,"stroke-width",t.strokeWidth),null!==t.strokeOpacity&&i.setAttributeNS(null,"stroke-opacity",t.strokeOpacity),null!==t.strokeLinejoin&&i.setAttributeNS(null,"stroke-linejoin",t.strokeLinejoin),null!==t.strokeLinecap&&i.setAttributeNS(null,"stroke-linecap",t.strokeLinecap),null!==t.strokeMiterlimit&&i.setAttributeNS(null,"stroke-miterlimit",t.strokeMiterlimit),null!==t.strokeDasharray&&i.setAttributeNS(null,"stroke-dasharray",t.strokeDasharray),null!==t.strokeDashoffset&&i.setAttributeNS(null,"stroke-dashoffset",t.strokeDashoffset)},w=(t,i,s,h)=>0===i?((t,i,s)=>{let h,l=Math.floor(Math.log(t)/Math.LN10),e=t/Math.pow(10,l);return i?h=e<2?.5:e<5?1:2:(h=e<1.5?1.5:e<2?2:e<3?3:e<4?4:e<5?5:e<6?6:e<7?7:10,s&&(h-=1)),Number((h*Math.pow(10,l)).toFixed(20))})(t,s,h):s?i:h?i*Math.floor(t/i):i*(Math.floor(t/i)+1),L=(t,i)=>{let s;if(null!=t[0].dataPoints[0][i]){for(let h=0;h<t.length;h++)for(let l=0;l<t[h].dataPoints.length;l++)(!s||parseInt(t[h].dataPoints[l][i])>parseInt(s[i]))&&(s=t[h].dataPoints[l]);return s}return null},z=(t,i)=>{let s;if(null!=t[0].dataPoints[0][i]){for(let h=0;h<t.length;h++)for(let l=0;l<t[h].dataPoints.length;l++)(!s||parseInt(t[h].dataPoints[l][i])<parseInt(s[i]))&&(s=t[h].dataPoints[l]);return s}return null},v=(t,i)=>{let s=null;if(null!=t[0].dataPoints[0][i]){for(let h=0;h<t.length;h++)for(let l=0;l<t[h].dataPoints.length;l++)(!s||t[h].dataPoints[l][i].length>s[i].length)&&(s=t[h].dataPoints[l]);return s}return null},_=(t,i,s,h)=>{let l={};if("label"===i&&t[0].dataPoints[0].label)l.label=v(t,"label").label,l.type="string",0!=s&&(l.interval=s);else if("x"===i&&"string"==typeof t[0].dataPoints[0].x)l.label=v(t,"x").x,l.type="string",0!=s&&(l.interval=s);else if("x"===i&&"number"==typeof t[0].dataPoints[0].x||"y"===i){let e,r;l.type="number","y"===i&&(e=L(t,i).y,r=z(t,i).y),"x"===i&&(e=L(t,i).x,r=z(t,i).x),e>0&&r>=0&&(l.top=w(e,s,!1,!1),h?(l.bottom=0,l.interval=w(e,s,!0,!1)):(l.bottom=w(r,s,!1,!0),l.interval=w(e-r,s,!0,!1)),l.length=l.top-l.bottom),e>0&&r<0&&(l.top=w(e,s,!1,!1),l.interval=w(e,s,!0,!1),l.bottom=-Math.ceil(-r/l.interval)*l.interval,l.length=l.top-l.bottom),e<=0&&(h?(l.top=0,l.interval=-w(-r,s,!0,!1)):(l.top=-w(-e,s,!1,!0),l.interval=-w(-(r-e),s,!0,!1)),l.bottom=-w(-r,s,!1,!1),l.length=l.top-l.bottom)}return l},P=(t,i,s)=>t.top+(i.top-s)*t.height/i.length,F=(t,i,s)=>t.left+(s-i.bottom)*t.width/i.length,S=t=>{for(;t.firstChild;)t.removeChild(t.firstChild)},T=(t,i)=>Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)),E=t=>{let i=0;for(let s=1;s<t.length;s++)i+=T(t[s],t[s-1]);return i},A=class{constructor(i){t(this,i),this.toggle=!1,this._update=!1}parseTitleProp(t){this.innerTitle=t||null}parseSubTitleProp(t){this.innerSubTitle=t||null}parseXTitleProp(t){this.innerXTitle=t||null}parseYTitleProp(t){this.innerYTitle=t||null}parseDataProp(t){const i=t||null;let s=[],h={status:200};if(null!=i){let t=JSON.parse(i),l=[];if(t instanceof Array?l=t:l.push(t),this._axisType=[],this._legendNames=[],this._legendColors=[],this._legendThicknesses=[],l.length>=1&&Object.keys(l[0]).length>=1){for(let t=0;t<l.length;t++)if(l[t].dataPoints){let i={};i.color=l[t].color?l[t].color:"#000000",i.name=l[t].name?l[t].name:null,i.lineThickness=l[t].lineThickness?l[t].lineThickness:1,i.markerType=l[t].markerType?l[t].markerType:"none",i.markerColor=l[t].markerColor?l[t].markerColor:i.color,i.markerSize=l[t].markerSize?l[t].markerSize:10,i.dataPoints=l[t].dataPoints,this._legendThicknesses.push(i.lineThickness),this._legendColors.push(i.color),null!==i.name&&this._legendNames.push(i.name),i.dataPoints[0].x?i.dataPoints[0].y?(0===t&&(i.dataPoints[0].x&&this._axisType.push("x"),i.dataPoints[0].y&&this._axisType.push("y")),s.push(i)):(s=null,h={status:400,message:"Error: no y data in dataset: "+t+" of data property"}):(s=null,h={status:400,message:"Error: no x data in dataset: "+t+" of data property"})}else s=null,h={status:400,message:"Error: no dataPoints object in dataset: "+t+" of data property"};200===h.status&&s&&s.length>1&&s.length!==this._legendNames.length&&(s=null,h={status:400,message:"Error: name attribute missing in some datasets"})}else s=null,h={status:400,message:"Error: no data provided"}}else s=null,h={status:400,message:"Error: no data property"};this.status=h,this.innerData=200===this.status.status?[...s]:null}parseStyleProp(t){this.innerStyle=t||null}parseAnimationProp(t){this.innerAnimation=t||!1}parseBorderProp(t){this.innerBorder=t||!1}parseDelayProp(t){this.innerDelay=t?parseFloat(t):100}init(){return Promise.resolve(this._init())}getStatus(){return Promise.resolve(this.status)}renderChart(){return Promise.resolve(this._renderChart())}async getWindowSize(){return(t=>({top:0,left:0,width:t.innerWidth,height:t.innerHeight}))(this.window)}async getCssProperties(){return this._prop}async componentWillLoad(){this.window=window,this._prop={},await this._init()}componentDidLoad(){this._element=this.el.shadowRoot,200===this.status.status&&this._renderChart()}async _init(){this.document=this.window.document,this.root=this.document.documentElement,this.window.addEventListener("resize",e(this,this._windowResize,100,!1),!1),this._selMarker=[],this._axisType=[],this._legendRect={},this._update=!1,this._dataColor=!1,this._yaxis={},this._xaxis={},this._legendRect={};let t=[];if(t=this._axisType.filter(t=>"label"===t),this._label=!1,"label"===t[0]&&(this._label=!0),this._showTarget=0,this._mouseStart=!1,this._xmlns="http://www.w3.org/2000/svg",this._xlink="http://www.w3.org/1999/xlink",this.parseTitleProp(this.ctitle?this.ctitle:null),this.parseSubTitleProp(this.subtitle?this.subtitle:null),this.parseXTitleProp(this.xtitle?this.xtitle:null),this.parseYTitleProp(this.ytitle?this.ytitle:null),this.parseAnimationProp(!!this.animation&&this.animation),this.parseBorderProp(!!this.cborder&&this.cborder),this.parseStyleProp(this.cstyle?this.cstyle:null),this.parseDelayProp(this.delay?this.delay:"100"),this._prop.topPlot=this._prop.topPlot?this._prop.topPlot:this._setPropertyValue("--chart-top",this.window.getComputedStyle(this.root).getPropertyValue("--chart-top")),this._prop.leftPlot=this._prop.leftPlot?this._prop.leftPlot:this._setPropertyValue("--chart-left",this.window.getComputedStyle(this.root).getPropertyValue("--chart-left")),this._prop.widthPlot=this._prop.widthPlot?this._prop.widthPlot:this._setPropertyValue("--chart-width",this.window.getComputedStyle(this.root).getPropertyValue("--chart-width")),this._prop.heightPlot=this._prop.heightPlot?this._prop.heightPlot:this._setPropertyValue("--chart-height",this.window.getComputedStyle(this.root).getPropertyValue("--chart-height")),this._prop.bgColor=this._prop.bgColor?this._prop.bgColor:this._setPropertyValue("--chart-background-color",this.window.getComputedStyle(this.root).getPropertyValue("--chart-background-color")),this._prop.tiColor=this._setPropertyValue("--chart-title-color",this.window.getComputedStyle(this.root).getPropertyValue("--chart-title-color")),this._prop.stColor=this._setPropertyValue("--chart-subtitle-color",this.window.getComputedStyle(this.root).getPropertyValue("--chart-subtitle-color")),this._prop.ftFamily=this._setPropertyValue("--chart-font-family",this.window.getComputedStyle(this.root).getPropertyValue("--chart-font-family")),this._prop.ftTiSize=this._setPropertyValue("--chart-title-font-size",this.window.getComputedStyle(this.root).getPropertyValue("--chart-title-font-size")),this._prop.ftSTSize=this._setPropertyValue("--chart-subtitle-font-size",this.window.getComputedStyle(this.root).getPropertyValue("--chart-subtitle-font-size")),this._prop.axColor=this._setPropertyValue("--chart-axis-color",this.window.getComputedStyle(this.root).getPropertyValue("--chart-axis-color")),this._prop.lnColor=this._setPropertyValue("--chart-line-color",this.window.getComputedStyle(this.root).getPropertyValue("--chart-line-color")),this._prop.atColor=this._setPropertyValue("--chart-axis-title-color",this.window.getComputedStyle(this.root).getPropertyValue("--chart-axis-title-color")),this._prop.lbColor=this._setPropertyValue("--chart-label-color",this.window.getComputedStyle(this.root).getPropertyValue("--chart-label-color")),this._prop.ftLbSize=this._setPropertyValue("--chart-label-font-size",this.window.getComputedStyle(this.root).getPropertyValue("--chart-label-font-size")),this._prop.ftATSize=this._setPropertyValue("--chart-axis-title-font-size",this.window.getComputedStyle(this.root).getPropertyValue("--chart-axis-title-font-size")),this._prop.ftSTSize=this._setPropertyValue("--chart-subtitle-font-size",this.window.getComputedStyle(this.root).getPropertyValue("--chart-subtitle-font-size")),this._prop.tickX=this._setPropertyValue("--chart-tick-x-length",this.window.getComputedStyle(this.root).getPropertyValue("--chart-tick-x-length")),this._prop.tickY=this._setPropertyValue("--chart-tick-y-length",this.window.getComputedStyle(this.root).getPropertyValue("--chart-tick-y-length")),this._prop.gridX=this._setPropertyValue("--chart-grid-x",this.window.getComputedStyle(this.root).getPropertyValue("--chart-grid-x")),this._prop.xInterval=this._setPropertyValue("--chart-axis-x-interval",this.window.getComputedStyle(this.root).getPropertyValue("--chart-axis-x-interval")),this._prop.yInterval=this._setPropertyValue("--chart-axis-y-interval",this.window.getComputedStyle(this.root).getPropertyValue("--chart-axis-y-interval")),this._prop.xZero=this._setPropertyValue("--chart-axis-x-zero",this.window.getComputedStyle(this.root).getPropertyValue("--chart-axis-x-zero")),this._prop.yZero=this._setPropertyValue("--chart-axis-y-zero",this.window.getComputedStyle(this.root).getPropertyValue("--chart-axis-y-zero")),this._prop.animDuration=this._setPropertyValue("--chart-animation-duration",this.window.getComputedStyle(this.root).getPropertyValue("--chart-animation-duration")),this._prop.legendTop=this._setPropertyValue("--chart-legend-top",this.window.getComputedStyle(this.root).getPropertyValue("--chart-legend-top")),this._prop.ftLgSize=this._setPropertyValue("--chart-legend-font-size",this.window.getComputedStyle(this.root).getPropertyValue("--chart-legend-font-size")),this._prop.bdColor=this._setPropertyValue("--chart-border-color",this.window.getComputedStyle(this.root).getPropertyValue("--chart-border-color")),this._prop.bdWidth=this._setPropertyValue("--chart-border-width",this.window.getComputedStyle(this.root).getPropertyValue("--chart-border-width")),null!=this.innerStyle){const t=await r(this.innerStyle);null!=t&&(this._prop.leftPlot=t.left?t.left:this._prop.leftPlot,this._prop.topPlot=t.top?t.top:this._prop.topPlot,this._prop.widthPlot=t.width?t.width:this._prop.widthPlot,this._prop.heightPlot=t.height?t.height:this._prop.heightPlot,this._prop.bgColor=t.backgroundcolor?t.backgroundcolor:this._prop.bgColor)}this.parseDataProp(this.data?this.data:null),this._wSize=await this.getWindowSize(),this._setContainerSize()}_setContainerSize(){this.w_width=a(this._prop.widthPlot,this._wSize.width,"0"),this.w_height=a(this._prop.heightPlot,this._wSize.height,"0"),this.el.style.setProperty("--top",this._prop.topPlot),this.el.style.setProperty("--left",this._prop.leftPlot),this.el.style.setProperty("--width",`${this.w_width}px`),this.el.style.setProperty("--height",`${this.w_height}px`),this.el.style.setProperty("--backgroundcolor",`${this._prop.bgColor}`),this._titleRect=null,this._chartRect={top:0,left:0,width:this.w_width,height:this.w_height}}_setPropertyValue(t,i){return"--chart-background-color"===t?i||"#ffffff":"color"===t.slice(-5)?i||"#000000":"border-width"===t.slice(-12)?i||"1":"font-size"===t.slice(-9)?i||"10px":"font-family"===t.slice(-11)?i||"Verdana":"grid"===t.slice(-6).substring(0,4)?i||"false":"zero"===t.slice(-4)?i||"true":"legend-top"===t.slice(-10)?i||"false":"duration"===t.slice(-8)?i||"1s":i||"0"}async _windowResize(){this._wSize=await this.getWindowSize(),this._setContainerSize(),this._update=!0,this.status&&200===this.status.status&&this._renderChart()}_createMarkers(){let t=u("defs",this.svg),i={id:"marker-circle",viewbox:"0 0 10 10"},s="M0,5 A5,5 0 1,1 10,5 A5,5 0 0,1 0,5 Z";m(t,s,i),i.id="marker-square",m(t,s="M0,0 L10,0 L10,10 L0,10 Z",i),i.id="marker-triangle",m(t,s="M5,0 L10,10 L0,10 Z",i),i.id="marker-cross",m(t,s="M0,2 L2,0 L5,3 L8,0 L10,2 L7,5 L10,8 L8,10 L5,7 L2,10 L0,8 L3,5 Z",i),i.id="marker-plus",m(t,s="M0,4 L4,4 L4,0 L6,0 L6,4 L10,4 L10,6 L6,6 L6,10 L4,10 L4,6 L0,6 Z",i)}_createTitle(){if(null!=this.innerTitle){let t,i;this._update?(t=this.svg.querySelector("#linechart-title")).removeAttributeNS(null,"transform"):(t=u("g",this.svg)).setAttributeNS(null,"id","linechart-title");let s={id:"linechart-title-text",fontFamily:this._prop.ftFamily,fontSize:this._prop.ftTiSize,fill:this._prop.tiColor,anchor:"middle"},h={x:Math.round(this.w_width/2),y:n(this._prop.ftTiSize)+10};if(i=this._update?d(this.svg,s.id,s.anchor,h):c(t,this.innerTitle,h,s),null!=this.innerSubTitle){const l=i.getBoundingClientRect();s.id="linechart-subtitle-text",s.fontSize=this._prop.ftSTSize,s.fill=this._prop.stColor;let e=Math.ceil(l.bottom-this.borderBB.top)+5;h={x:Math.round(this.w_width/2),y:e+10},this._update?d(this.svg,s.id,s.anchor,h):c(t,this.innerSubTitle,h,s)}const l=t.getBoundingClientRect();let e=((t,i)=>t<i-20?1:Number(((i-20)/t).toFixed(4)))(l.width,this.w_width),r="translate("+Math.round(10-l.left*e)+",0) scale("+e+","+e+")";1!=e&&t.setAttributeNS(null,"transform",r);const a=t.getBoundingClientRect();this._titleRect={left:a.left-this.borderBB.left,top:a.top-this.borderBB.top,width:a.width,height:a.height}}}_createAxis(){let t,i=n(this._prop.tickX),s=n(this._prop.tickY),h=parseFloat(this._prop.xInterval),l=parseFloat(this._prop.yInterval);this._update?t=this.svg.querySelector("#linechart-axes"):(t=u("g",this.svg)).setAttributeNS(this._xmlns,"id","linechart-axes"),this._initChartRect(),this.innerData.length>1&&this._createLegend();let e=this._createTitleY(),r=this._createTitleX();this._lenY=_(this.innerData,"y",l,o(this._prop.yZero)),this._lenX=this._label?_(this.innerData,"label",h):_(this.innerData,"x",h,o(this._prop.xZero));let a=this._labelSize(this._lenY,0);this._x_axy=3+a.width+2+s,this._nXlines=this.innerData[0].dataPoints.length,this._lenX.interval&&"number"===this._lenX.type&&(this._nXlines=Math.abs(Math.floor(this._lenX.length/this._lenX.interval))+1);let p=this._chartRect.width-this._x_axy;this._xInterval=Math.floor(p/this._nXlines),this._lenX.interval&&"number"===this._lenX.type&&(this._xInterval=p/(this._nXlines-1));let y=this._xInterval;this._lenX.interval&&"string"===this._lenX.type&&(this._nXlines=Math.abs(Math.floor(this.innerData[0].dataPoints.length/this._lenX.interval)),y=p/this._nXlines),this._labelRotate=!1;let m=this._labelSize(this._lenX,0);m.width>y-10&&(m=this._labelSize(this._lenX,-80),this._labelRotate=!0),this._y_axy=10+m.height+3+i,this._yaxis={},this._yaxis.left=this._chartRect.left+this._x_axy,this._yaxis.width=0,this._yaxis.top=this._chartRect.top,this._yaxis.height=this._chartRect.height-this._y_axy;let g={id:"linechart-yaxis",stroke:this._prop.axColor,strokeWidth:"1"},b={x:this._yaxis.left,y:this._yaxis.top},M={x:this._yaxis.left+this._yaxis.width,y:this._yaxis.top+this._yaxis.height};if(this._update?x(this.svg,g.id,b,M):f(t,b,M,g),null!=e){let t="translate(0,0)";e.setAttributeNS(null,"transform",t);let i=e.getBoundingClientRect(),s=-Math.round(i.top-this.borderBB.top+i.height/2-(this._yaxis.top+this._yaxis.height/2));e.setAttributeNS(null,"transform",t="translate(0,"+s+")")}let k={id:"linechart-ylabel0",stroke:this._prop.lbColor,strokeWidth:"1",fontFamily:this._prop.ftFamily,fontSize:this._prop.ftLbSize,anchor:"end"},w=Math.floor(parseFloat(this._prop.ftLbSize.split("px")[0])/2)-2;this._nYlines=Math.abs(Math.floor(this._lenY.length/this._lenY.interval))+1;for(let n=0;n<this._nYlines;n++){let i=this._lenY.top-n*Math.abs(this._lenY.interval);g.id="linechart-yLine"+i.toString(),g.stroke=this._prop.lnColor,n===this._nYlines-1&&(g.id="linechart-xaxis",g.stroke=this._prop.axColor),k.id="linechart-ylabel"+i.toString();let h=P(this._yaxis,this._lenY,i),l={x:this._yaxis.left,y:h},e={x:this._chartRect.left+this._chartRect.width,y:h};if(this._update?x(this.svg,g.id,l,e):f(t,l,e,g),s>0){let e={x:this._yaxis.left-s,y:h};g.id="linechart-ytick"+i.toString(),this._update?x(this.svg,g.id,l,e):f(t,l,e,g)}let r={x:this._yaxis.left-s-2,y:h+w};this._update?d(this.svg,k.id,k.anchor,r):c(t,i.toString(),r,k)}let L=this.svg.querySelector("#linechart-xaxis"),z=parseFloat(L.getAttribute("y1")),v=Math.floor(this._xInterval/2);this._lenX.interval&&"number"===this._lenX.type&&(v=0),k={id:"linechart-xlabel",stroke:this._prop.lbColor,strokeWidth:"1",fontFamily:this._prop.ftFamily,fontSize:this._prop.ftLbSize,anchor:"middle"},w=Math.floor(n(this._prop.ftLbSize));for(let n=0;n<this._nXlines;n++){let s,h,l,e=this._lenX.bottom+n*Math.abs(this._lenX.interval),r={x:this._yaxis.left+v,y:z};if(o(this._prop.gridX)){g.id="linechart-xLine"+n.toString(),this._lenX.interval&&"number"===this._lenX.type&&(g.id="linechart-xLine"+e.toString()),this._lenX.interval&&"string"===this._lenX.type&&(g.id="linechart-xLine"+(n*this._lenX.interval).toString()),g.stroke=this._prop.lnColor;let i={x:this._yaxis.left+v,y:this._yaxis.top};(!this._lenX.interval||n>=1||"number"!=this._lenX.type)&&(this._update?x(this.svg,g.id,r,i):f(t,r,i,g))}if(i>0){let s={x:this._yaxis.left+v,y:z+i};g.id="linechart-xtick"+n.toString(),this._lenX.interval&&"number"===this._lenX.type&&(g.id="linechart-xtick"+e.toString()),this._lenX.interval&&"string"===this._lenX.type&&(g.id="linechart-xtick"+(n*this._lenX.interval).toString()),this._update?x(this.svg,g.id,r,s):f(t,r,s,g)}s="string"===this._lenX.type?this.innerData[0].dataPoints[n*(void 0!==this._lenX.interval?this._lenX.interval:1)].x:e.toString(),k.id="linechart-xlabel"+s;let a=null;this._labelRotate?(k.anchor="end",a="rotate(-80,"+(l={x:this._yaxis.left+v,y:z+i+3}).x+","+l.y+")"):(k.anchor="middle",a="rotate(0,"+(l={x:this._yaxis.left+v,y:z+i+w}).x+","+l.y+")"),h=this._update?d(this.svg,k.id,k.anchor,l):c(t,s,l,k),null!=a&&h.setAttributeNS(null,"transform",a),v+=this._lenX.interval&&"string"===this._lenX.type?this._xInterval*this._lenX.interval:this._xInterval}if(null!=r){r.setAttributeNS(null,"transform","translate(0,0)");let t=L.getBoundingClientRect(),i=r.getBoundingClientRect(),s=-Math.round(i.left+i.width/2-(t.left+t.width/2));Math.abs(s)>0&&r.setAttributeNS(null,"transform","translate("+s+",0)")}}_labelSize(t,i){let s,h={fontFamily:this._prop.ftFamily,fontSize:this._prop.ftLbSize,fill:this._prop.lbColor,anchor:"start"};if(t.label)s=t.label;else{s=t.top.toString();let i=t.bottom.toString();i.length>s.length&&(s=i)}let l=c(this.svg,s,{x:0,y:0},h);0!=i&&l.setAttributeNS(null,"transform","rotate("+i+",0,0)");let e=l.getBoundingClientRect();return this.svg.removeChild(l),{width:Math.ceil(e.width),height:Math.ceil(e.height)}}_initChartRect(){this._chartRect.top=20,null!=this._titleRect&&(this._chartRect.top+=Math.round(this._titleRect.height)),this._chartRect.left=0,this._chartRect.width=this.w_width-this._chartRect.left-20,this._chartRect.height=this.w_height-this._chartRect.top}_createLegend(){let t,i={},s={fontFamily:this._prop.ftFamily,fontSize:this._prop.ftLgSize,anchor:"start"},h=((t,i,s,h,l,e)=>{let r=(t=>{let i=null;for(let s=0;s<t.length;s++)(!i||t[s].length>i.length)&&(i=t[s]);return i})(s),a={};a.bBoxItem=((t,i,s)=>{let h=u("g",t);b(h,{x:0,y:0},{x:15,y:0},{stroke:"#000000"},i,{x:20,y:0},s);let l=h.getBoundingClientRect();return t.removeChild(h),l})(t,r,e),a.nItems=Math.floor((i-20)/(a.bBoxItem.width+20)),a.nItems>s.length&&(a.nItems=s.length),a.lineLength=a.nItems*(a.bBoxItem.width+20),a.nLines=Math.ceil(s.length/a.nItems);let n=u("g",t);return g(n,s,h,l,a,i,10,e),a.bBox=n.getBoundingClientRect(),t.removeChild(n),a})(this.svg,this.w_width,this._legendNames,this._legendColors,this._legendThicknesses,s);i.left=h.bBox.left,i.width=h.bBox.width,o(this._prop.legendTop)?(i.top=this._chartRect.top+15,this._chartRect.top+=Math.ceil(h.bBox.height)+15):i.top=Math.floor(this._chartRect.top+this._chartRect.height-h.bBox.height),i.height=h.bBox.height,this._chartRect.height-=Math.floor(h.bBox.height)+10,this._update?(t=this.svg.querySelector("#linechart-legend"),S(t),g(t,this._legendNames,this._legendColors,this._legendThicknesses,h,this.w_width,i.top,s)):((t=u("g",this.svg)).setAttributeNS(null,"id","linechart-legend"),g(t,this._legendNames,this._legendColors,this._legendThicknesses,h,this.w_width,i.top,s))}_createTitleY(){let t,i={id:"linechart-ytitle-text",fontFamily:this._prop.ftFamily,fontSize:this._prop.ftATSize,fill:this._prop.atColor,anchor:"middle"};if(null!=this.innerYTitle){let s;this._update?t=this.svg.querySelector("#linechart-ytitle"):(t=u("g",this.svg)).setAttributeNS(null,"id","linechart-ytitle");let h=this._chartRect.top+Math.round(this._chartRect.height/2),l={x:5+parseFloat(this._prop.ftATSize.split("px")[0]),y:h};s=this._update?d(this.svg,i.id,i.anchor,l):c(t,this.innerYTitle,l,i);let e="rotate(-90 "+l.x.toString()+" "+l.y.toString()+")";s.setAttributeNS(null,"transform",e);let r=t.getBoundingClientRect();return this._chartRect.left=Math.ceil(r.right-this.borderBB.left),this._chartRect.width-=Math.ceil(r.right-this.borderBB.left),t}return null}_createTitleX(){let t={id:"linechart-xtitle-text",fontFamily:this._prop.ftFamily,fontSize:this._prop.ftATSize,fill:this._prop.atColor,anchor:"middle"};if(null!=this.innerXTitle){let i;this._update?i=this.svg.querySelector("#linechart-xtitle"):(i=u("g",this.svg)).setAttributeNS(null,"id","linechart-xtitle");let s=this._chartRect.top+this._chartRect.height-15,h={x:Math.round(this._chartRect.left+this._chartRect.width/2),y:s};this._update?d(this.svg,t.id,t.anchor,h):c(i,this.innerXTitle,h,t);let l=i.getBoundingClientRect();return this._chartRect.height-=Math.floor(l.height),i}return null}_createLine(){let t;this._Points=[],this._update?t=this.svg.querySelector("#linechart-data"):(t=u("g",this.svg)).setAttributeNS(null,"id","linechart-data");for(let i=0;i<this.innerData.length;i++){let s,h,l=[],e={};e.stroke=this.innerData[i].color,e.strokeWidth=this.innerData[i].lineThickness.toString(),e.fill="none",e.id="linechart-data-"+i.toString(),this._xaxis.left=this._yaxis.left,this._xaxis.width=this._chartRect.left+this._chartRect.width-this._xaxis.left;let r=Math.floor(this._xInterval/2);for(let n=0;n<this.innerData[i].dataPoints.length;n++){e.stroke=this.innerData[i].dataPoints[n].color?this.innerData[i].dataPoints[n].color:this.innerData[i].color;let h={};h.y=P(this._yaxis,this._lenY,this.innerData[i].dataPoints[n].y),h.x=this._lenX.interval&&"number"===this._lenX.type?F(this._xaxis,this._lenX,this.innerData[i].dataPoints[n].x):this._xaxis.left+r,l.push(h),this._placeMarker("marker-"+this.innerData[i].markerType,t,h,i,n,this.innerData[i].markerSize/10,this.innerData[i].markerColor),0===n?s=h.x.toString()+","+h.y.toString():s+=" "+h.x.toString()+","+h.y.toString(),r+=this._xInterval}e.strokeLinejoin="round",e.strokeLinecap="round",e.strokeMiterlimit="10";let a=E(l);h=this._update?y(this.svg,e.id,s):p(t,s,e),this.innerAnimation&&(h.setAttributeNS(null,"stroke-dasharray",a.toString()+","+a.toString()),h.setAttributeNS(null,"stroke-dashoffset",a.toString()),this._setAnimation(h,a.toString(),this._prop.animDuration)),this._Points.push(l)}}_setAnimation(t,i,s){let h={attributeName:"stroke-dashoffset"};h.from=i,h.to="0",h.dur=s,h.fill="freeze",((t,i)=>{let s=u("animate",t);s.setAttributeNS(null,"attributeName",i.attributeName),s.setAttributeNS(null,"from",i.from),s.setAttributeNS(null,"to",i.to),s.setAttributeNS(null,"dur",i.dur),s.setAttributeNS(null,"fill",i.fill)})(t,h)}_placeMarker(t,i,s,h,l,e,r){let a,n;this._update?a=(n=i.querySelector("#"+t+"-g-"+h.toString()+"-"+l.toString())).querySelector("#"+t+"-"+h.toString()+"-"+l.toString()):(n=u("g",i),a=u("use",n)),n.setAttributeNS(null,"id",t+"-g-"+h.toString()+"-"+l.toString()),n.setAttribute("style","fill:"+r),a.setAttributeNS(this._xlink,"xlink:href","#"+t),a.setAttributeNS(null,"id",t+"-"+h.toString()+"-"+l.toString()),a.setAttributeNS(null,"x",(s.x-5).toString()),a.setAttributeNS(null,"y",(s.y-5).toString()),a.setAttributeNS(null,"width","10"),a.setAttributeNS(null,"height","10"),this._scaleMarker(a,e,s)}_scaleMarker(t,i,s){let h=1-i,l={};l.x=h*s.x,l.y=h*s.y;let e="translate("+l.x.toString()+","+l.y.toString()+") scale("+i+")";t.setAttributeNS(null,"transform",e)}_highlightMarker(t,i){let s=t.getAttributeNS(null,"transform"),h={};h.x=parseFloat(t.getAttributeNS(null,"x"))+5,h.y=parseFloat(t.getAttributeNS(null,"y"))+5;let l=1;null!=s&&(l=parseFloat(s.split("scale(")[1].slice(0,-1))),this._scaleMarker(t,i?l/1.5:1.5*l,h)}_waitRemoveLabel(){this._mouseStart&&setTimeout(()=>{this._removeLabel(this.svg),this._mouseStart=!1,this._showTarget=0},1200)}_removeLabel(t){let i=t.querySelectorAll("#linechart-label-value");if(i.length>0)for(let s=0;s<i.length;s++)S(i[s]),t.removeChild(i[s]);if(this._selMarker.length>0)for(let s=0;s<this._selMarker.length;s++){let t=this.svg.querySelector(this._selMarker[s]);this._highlightMarker(t,!0)}this._selMarker=[]}_handleTouchDown(t){t.preventDefault(),this._mouseStart=!0,this._handleEventTarget(t,{x:t.touches[0].pageX,y:t.touches[0].pageY})}_handleMouseDown(t){t.preventDefault(),this._mouseStart=!0,this._handleEventTarget(t,{x:t.pageX,y:t.pageY})}_handleTouchUp(t){t.preventDefault(),this._waitRemoveLabel()}_handleMouseUp(t){t.preventDefault(),this._waitRemoveLabel()}_handleEventTarget(t,i){this._showTarget=t.target,i.x-=this.borderBB.left,i.y-=this.borderBB.top,this._removeLabel(this.svg);let s=((t,i)=>{let s=null,h=1e20;for(let l=0;l<t.length;l++)for(let e=0;e<t[l].length;e++){let r=T(t[l][e],i);r<h&&(s={line:l,index:e,point:t[l][e]},h=r)}return s})(this._Points,i),h=this.innerData[s.line].dataPoints[s.index],e="#marker-"+this.innerData[s.line].markerType+"-";e+=s.line.toString()+"-"+s.index.toString(),this._selMarker.push(e);let r,a=this.svg.querySelector(e);this._highlightMarker(a,!1),"number"==typeof h.x&&(r=h.x.toString()),"string"==typeof h.x&&(r=h.x),r=r+" : "+h.y.toString();let n=1.2*parseFloat(this._prop.ftLbSize.split("px")[0]),o={fontFamily:this._prop.ftFamily,fontSize:n.toString()+"px",fill:this._prop.lbColor,anchor:"middle"};(async(t,i,s,h,e)=>{let r=M(e),a=await(async(t,i,s,h)=>{const e=h||l;let r=u("text",t);r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y","0"),k(s,r,"text"),r.textContent=i;let a=await e(r);return t.removeChild(r),a})(t,i,r),n={};n.width=a.width+10,n.height=a.height+10,n.left=s.point.x-n.width-10>0?Math.floor(s.point.x-n.width-10):Math.floor(s.point.x+10),n.top=Math.floor(s.point.y-n.height-10),((t,i,s,h,l,e)=>{let r=u("g",t);r.setAttributeNS(null,"id",i);let a=u("rect",r);a.setAttributeNS(null,"x",h.left.toString()),a.setAttributeNS(null,"y",h.top.toString()),a.setAttributeNS(null,"width",h.width.toString()),a.setAttributeNS(null,"height",h.height.toString()),a.setAttributeNS(null,"stroke",l),a.setAttributeNS(null,"fill","#ffffff"),a.setAttributeNS(null,"fill-opacity","0.85");let n=u("text",r),o=h.top+3*h.height/4;n.setAttributeNS(null,"x",(h.left+h.width/2).toString()),n.setAttributeNS(null,"y",o.toString()),k(e,n,"text"),n.textContent=s})(t,"linechart-label-value",i,n,h,r)})(this.svg,r,s,this.innerData[s.line].color,o)}async _renderChart(){this.container=this._element.querySelector("#div-linechart-container"),this.chart=this._element.querySelector("#div-linechart-chart"),this.svg=this._element.querySelector("#svg-linechart"),this.borderEl=this.svg.querySelector("#svg-border-rect"),this.borderBB=await l(this.borderEl,this.innerDelay),0==this.borderBB.top&&0==this.borderBB.left&&0==this.borderBB.width&&0==this.borderBB.height||(this.container.addEventListener("touchstart",this._handleTouchDown.bind(this),!1),this.container.addEventListener("touchend",this._handleTouchUp.bind(this),!1),this.container.addEventListener("mousedown",this._handleMouseDown.bind(this),!1),this.container.addEventListener("mouseup",this._handleMouseUp.bind(this),!1),this.innerBorder&&this.borderEl.classList.remove("hidden"),this._createMarkers(),null!=this.innerTitle&&this.innerTitle.length>0&&this._createTitle(),this._createAxis(),this._createLine())}render(){if(200===this.status.status){let t=`0 0 ${this.w_width.toString()} ${this.w_height.toString()}`;return i(s,null,i("div",{id:"div-linechart-container"},i("div",{id:"div-linechart-chart"},i("svg",{id:"svg-linechart",width:this.w_width.toString(),height:this.w_height.toString(),viewBox:t},i("rect",{id:"svg-border-rect",class:"border-rect hidden",x:"0",y:"0",width:this.w_width.toString(),height:this.w_height.toString(),stroke:this._prop.bdColor,"stroke-width":this._prop.bdWidth,fill:"none","fill-opacity":"0"})))))}return i("div",{id:"div-error-message"},i("p",{id:"p-error-message"},this.status.message))}get el(){return h(this)}static get watchers(){return{ctitle:["parseTitleProp"],subtitle:["parseSubTitleProp"],xtitle:["parseXTitleProp"],ytitle:["parseYTitleProp"],data:["parseDataProp"],cstyle:["parseStyleProp"],animation:["parseAnimationProp"],cborder:["parseBorderProp"],delay:["parseDelayProp"]}}static get style(){return":host{--height:200px;--width:300px;--top:30px;--left:10px;--backgroundcolor:#fff}#div-linechart-container{position:relative;left:0;top:0;width:100%;height:calc(var(--height) + var(--top));z-index:1}#div-linechart-chart{position:relative;left:var(--left);top:var(--top);width:var(--width);height:var(--height);background-color:var(--backgroundcolor);z-index:1}.hidden{visibility:hidden}#div-error-message{background-color:#f89393;position:absolute;top:0;left:0;margin:0 auto;width:100%;height:60px;line-height:60px;text-align:left;padding-left:10px;font-size:15px;font-family:Verdana}#p-error-message{display:inline-block;vertical-align:middle;line-height:normal}"}};export{A as jeep_linechart};